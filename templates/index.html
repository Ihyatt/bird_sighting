{% extends 'base.html' %}
{% block content %}



<div class="row" >

	<div class="col-md-4  col-sm-4  col-xs-4 col-xs-offset-1" >

	<div class="row" style="background-color:black; opacity: 0.5; padding: 50px; margin: 20px;">


		<h4>Log le bird sightings</h4>
		<div style="margin:5px;">
		<label>le species</label>
	        <input type="text" class="form-control" placeholder="Robin..." id="bird_species">
	    </div>
	    <div style="margin:5px;">
	    <label>le quantity</label>
	        <input type="number" class="form-control" placeholder="2..." id="quantity">
	    </div>
	    <div style="margin:5px;">
	    <button type="button" id="add-sighting"class="btn btn-default" style="
    font-size: 12px;
    font-weight: 300;
    text-transform: uppercase;"> add le sighting </button>
   	</div>


	</div>

	<div class="row" style="background-color:black; opacity: 0.5;padding: 50px; margin: 20px;">	

	<h4>When to find le bird</h4>
	<div style="margin:5px;">

	      <div class="input-group">
	         <span class="input-group-addon glyphicon glyphicon-search search-sighting"  id="basic-addon1"></span>
	         <input type="text" id="search" class="form-control" placeholder="Chickadee..." aria-describedby="basic-addon1">
	      </div>
	</div>
	<div style="margin:5px;">   
	<ul id="bird-sighting">
	</ul>
	</div>
</div>

	<div class="row" style="background-color:black; opacity: 0.5;padding: 50px; margin: 20px;">
		<div style="margin:5px;">
		<button type="button" id="view-probabilities"class="btn btn-default" style="
    font-size: 12px;
    font-weight: 300;
    text-transform: uppercase;"> le birds and probability </button>
</div>
<div style="margin:5px;">
		<ul id="all-birds">
	</ul>
</div>

	</div>

	</div>
</div>



<script>
// JS for return Search
function showChanceSighting(results) {
	var returnedBird = results;
	$("#bird-sighting").append("<div style='margin-top:10px;margin-bottom:10px;'>" + "Here are the time(s) you should check out Le Bird!" + "</div>")

	for (var key in returnedBird){

	$("#bird-sighting").append("<li>" + returnedBird[key] +" " + key + "</li>")
 };

	$("#search").val("")
}
function getProbability() {
	var searchBird = $("#search").val();
	console.log(searchBird)
	var search_bird = {
		"bird": searchBird
	};
	$.get("/return-search.json", search_bird, showChanceSighting);
	$("#bird-sighting").html("")
}

$(".search-sighting").click(getProbability)

// JS for submitting bird sightings
function sightingSubmitted() {
	// check for succes of AJAX request
}
function submitSighting() {
	var submitBird = $("#bird_species").val();
	var submitQuantity = $("#quantity").val();
	var submission = {
		"bird": submitBird,
		"quantity": submitQuantity
	};
	$.post("/submit-bird", submission, sightingSubmitted);
	$("#bird_species").val("")
	$("#quantity").val("")
}
$("#add-sighting").click(submitSighting)




// JS for wanting to see all birds and probability 

function showAllBirds(results){
	var returnedAllBirds = results;
		$("#all-birds").append("<div style='margin-top:10px;margin-bottom:10px;'>" + "Here are the chances you have to see le birds!" + "</div>")

	for (var key in returnedAllBirds){
	$("#all-birds").append("<li>" + key + " " + returnedAllBirds[key] + "%" +  "</li>")
 };


}

function viewAllBirds() {
	$.get("/return-all-birds.json", showAllBirds);
	$("#view-probabilities").html("refresh le probabilities");
	$("#all-birds").html("")
}


$("#view-probabilities").click(viewAllBirds)
</script>

{% endblock %}